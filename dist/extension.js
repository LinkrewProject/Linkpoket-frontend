import{r as a,j as e,b as y,c as b}from"./assets/global.oW105N5-.js";const j=()=>{const[o,u]=a.useState(null),[l,g]=a.useState(null),[c,i]=a.useState(""),[d,p]=a.useState(""),[x,m]=a.useState("");a.useEffect(()=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{const r=t[0],n=r==null?void 0:r.url,s=r==null?void 0:r.title;n&&p(n),s&&i(s)})},[]),a.useEffect(()=>{chrome.runtime.sendMessage({type:"GET_PERSONAL_PAGE_DATA"},t=>{var r,n;if(chrome.runtime.lastError){console.error("personalPageData 요청 중 에러:",chrome.runtime.lastError.message);return}if(t&&t.data)try{const s=JSON.parse(t.data);console.log("받아온 personalPageData:",s),u((n=(r=s==null?void 0:s.data)==null?void 0:r.data)==null?void 0:n.pageDetails)}catch(s){console.error("personalPageData 파싱 실패:",s)}else console.log("personalPageData 없음")}),chrome.storage.local.get(["access_token"],t=>{if(chrome.runtime.lastError){console.error("access_token 요청 중 에러:",chrome.runtime.lastError.message);return}const r=t.access_token;r?(console.log("받아온 access_token:",r),g(r)):console.log("accessToken 없음")}),o&&m(o.rootFolderId)},[o]);const f=async()=>{try{const t=await fetch("http://localhost:8080/api/links",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({baseRequest:{pageId:(o==null?void 0:o.pageId)??"",commandType:"CREATE"},linkName:c,linkUrl:d,directoryId:x})});if(!t.ok){const r=await t.text();throw new Error(`요청 실패: ${r}`)}alert("저장에 성공했습니다.")}catch(t){console.error("링크 생성 실패:",t)}},h=()=>{window.open("https://linkrew.com/login","_blank")};return o?l?e.jsxs("div",{className:"rounded-2 flex h-full w-[300px] flex-col gap-4 border border-[#D8D8D8] bg-[#FFFFFF] p-4 shadow-[0_4px_16px_0_rgba(0,0,0,0.08)]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("img",{src:"/logo.png",alt:"Linkrew Logo",className:"h-[18px] w-[90px]"}),e.jsx("img",{src:"/close.png",alt:"Close",onClick:()=>window.close(),className:"cursor-pointer"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{contentEditable:!0,className:"bg-gray-5 border-gray-5 text-gray-90 line-clamp-3 rounded-[8px] border p-4 text-[15px] font-semibold break-all whitespace-pre-wrap placeholder:text-gray-50 empty:before:text-gray-50 empty:before:content-[attr(data-placeholder)] focus:outline-none","data-placeholder":"링크 이름을 입력해주세요",onInput:t=>{const r=t.currentTarget.textContent||"";i(r)},suppressContentEditableWarning:!0,children:c}),e.jsx("div",{contentEditable:!0,className:"line-clamp-3 resize-none overflow-hidden text-[13px] font-[400] break-all whitespace-pre-wrap text-[#8E8E8E] placeholder:text-gray-50 empty:before:text-gray-50 empty:before:content-[attr(data-placeholder)] focus:outline-none","data-placeholder":"링크 주소를 입력해주세요",onInput:t=>{const r=t.currentTarget.textContent||"";p(r)},suppressContentEditableWarning:!0,style:{maxHeight:"60px"},children:d})]}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("p",{className:"text-gray-70 mb-2 text-[14px] font-[500]",children:"페이지"}),e.jsx("div",{className:"border-gray-30 rounded-[8px] border p-2 text-sm",children:"개인 페이지"}),e.jsx("p",{className:"text-gray-70 mt-4 mb-2 text-[14px] font-[500]",children:"폴더(선택)"}),e.jsxs("select",{className:"border-gray-30 focus:ring-primary-30 focus:border-primary-40 hover:border-primary-40 flex h-[44px] items-center rounded-[8px] border p-2 text-sm placeholder:text-gray-50 focus:outline-none",value:x,onChange:t=>m(t.target.value),children:[e.jsx("option",{value:o.rootFolderId,children:"선택 안 함"}),o.directoryDetailRespons.map(t=>e.jsx("option",{value:t.folderId,children:t.folderName},t.folderId))]})]}),e.jsx("button",{className:"text-primary-0 bg-primary-50 flex flex-1 cursor-pointer items-center justify-center rounded-[8px] px-[16px] py-[10px] text-center text-[14px] font-[600]",onClick:f,children:"저장"})]})]}):e.jsxs("div",{className:"rounded-2 flex h-full w-[300px] flex-col gap-4 border border-[#D8D8D8] bg-[#FFFFFF] p-4 shadow-[0_4px_8px_0_rgba(0,0,0,0.08)]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("img",{src:"/logo.png",alt:"Linkrew Logo"}),e.jsx("img",{src:"/close.png",alt:"Close",onClick:()=>window.close(),className:"cursor-pointer"})]}),e.jsxs("div",{className:"mt-9 text-[16px] font-[700] text-gray-100",children:["간편 로그인 후 ",e.jsx("br",{})," 링크를 저장할 수 있어요."]}),e.jsx("button",{className:"mt-6 flex flex-1 cursor-pointer items-center justify-center rounded-[8px] bg-[#F2F2F2] px-[16px] py-[10px] text-center text-[14px] font-[600]",onClick:h,children:"로그인"})]}):e.jsx("div",{className:"width-[300px] text-center",children:"데이터 로딩 중입니다."})};window.addEventListener("error",o=>{y.isAxiosError(o.error)&&o.preventDefault()});b.createRoot(document.getElementById("root")).render(e.jsx(a.StrictMode,{children:e.jsx(j,{})}));
